stages:
  - build
  - test

build:
  stage: build
  image: golang:latest
  script:
    - go mod tidy
    - make build
  only:
    - devtask/GOJHW-3

test:
  stage: test
  image: golang:latest
  script:
    - go install
    - go test ./... -coverprofile=coverage.txt -covermode count
    - go get github.com/boumenot/gocover-cobertura
    - go run github.com/boumenot/gocover-cobertura < coverage.txt > coverage.xml
  artifacts:
    reports:
      coverage_report:
        coverage_format: cobertura
  only:
    - develop/GOJHW-3
